<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interval system solution set · IntervalLinearAlgebra.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://juliaintervals.github.io/IntervalLinearAlgebra.jl/explanations/solution_set/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IntervalLinearAlgebra.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IntervalLinearAlgebra.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/linear_systems/">Linear systems</a></li></ul></li><li><a class="tocitem" href="../../wip/">Applications</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Interval system solution set</a><ul class="internal"><li><a class="tocitem" href="#Interval-linear-systems"><span>Interval linear systems</span></a></li><li><a class="tocitem" href="#Solution-by-Monte-Carlo"><span>Solution by Monte-Carlo</span></a></li><li><a class="tocitem" href="#Oettli-Präger-theorem"><span>Oettli-Präger theorem</span></a></li><li><a class="tocitem" href="#Disadvantages-of-Oettli-Präger"><span>Disadvantages of Oettli-Präger</span></a></li></ul></li><li><a class="tocitem" href="../preconditioning/">Preconditioning</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/classify/">Interval matrices classification</a></li><li><a class="tocitem" href="../../api/solve/">Solver interface</a></li><li><a class="tocitem" href="../../api/algorithms/">Interval linear systems</a></li><li><a class="tocitem" href="../../api/precondition/">Preconditioners</a></li><li><a class="tocitem" href="../../api/epsilon_inflation/">Verified real linear systems</a></li><li><a class="tocitem" href="../../api/eigenvalues/">Eigenvalues</a></li><li><a class="tocitem" href="../../api/misc/">Miscellaneous</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li><li><a class="tocitem" href="../../CONTRIBUTING/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Explanations</a></li><li class="is-active"><a href>Interval system solution set</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interval system solution set</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaIntervals/IntervalLinearAlgebra.jl/blob/master/docs/src/explanations/solution_set.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Solution-set-of-interval-linear-system"><a class="docs-heading-anchor" href="#Solution-set-of-interval-linear-system">Solution set of interval linear system</a><a id="Solution-set-of-interval-linear-system-1"></a><a class="docs-heading-anchor-permalink" href="#Solution-set-of-interval-linear-system" title="Permalink"></a></h1><ul><li><a href="#Solution-set-of-interval-linear-system">Solution set of interval linear system</a></li><ul><li><a href="#Interval-linear-systems">Interval linear systems</a></li><li><a href="#Solution-by-Monte-Carlo">Solution by Monte-Carlo</a></li><li><a href="#Oettli-Präger-theorem">Oettli-Präger theorem</a></li><li><a href="#Disadvantages-of-Oettli-Präger">Disadvantages of Oettli-Präger</a></li></ul></ul><h2 id="Interval-linear-systems"><a class="docs-heading-anchor" href="#Interval-linear-systems">Interval linear systems</a><a id="Interval-linear-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Interval-linear-systems" title="Permalink"></a></h2><p>An interval linear system is defined as</p><p class="math-container">\[\mathbf{A}\mathbf{x}=\mathbf{b}\]</p><p>where <span>$\mathbf{A}\in\mathbb{I}\mathbb{R}^{n\times n}$</span> and <span>$\mathbf{b}\in\mathbb{I}\mathbb{R}^n$</span> are an interval matrix and vector, respectively.</p><p>The solution set  <span>$\mathbf{x}$</span> is defined as</p><p class="math-container">\[\mathbf{x} = \{x \in \mathbb{R}^n | Ax=b \text{ for some } A\in\mathbf{A}, b\in\mathbf{b} \}.\]</p><p>In other words, <span>$\mathbf{x}$</span> is the set of solutions of the real linear systems <span>$Ax=b$</span> for some  <span>$A\in\mathbf{A}$</span> and <span>$b\in\mathbf{b}$</span>. If the interval matrix <span>$\mathbf{A}$</span> is <em>regular</em>, that is all <span>$A\in\mathbf{A}$</span> are invertible, then the solution set <span>$\mathbf{x}$</span> will be non-empty and bounded. In general, checking for regularity of an interval matrix has exponential complexity.</p><h2 id="Solution-by-Monte-Carlo"><a class="docs-heading-anchor" href="#Solution-by-Monte-Carlo">Solution by Monte-Carlo</a><a id="Solution-by-Monte-Carlo-1"></a><a class="docs-heading-anchor-permalink" href="#Solution-by-Monte-Carlo" title="Permalink"></a></h2><p>A naive approach to solve an interval linear system would be to use Montecarlo, i.e. to randomly sample elements from the intervals and solve the several random real systems. Suppose we want to solve the linear system</p><p class="math-container">\[\begin{bmatrix}
[2, 4]&amp;[-2,1]\\
[-1, 2]&amp;[2, 4]
\end{bmatrix}\mathbf{x} =
\begin{bmatrix}
[-2, 2]\\
[-2, 2]
\end{bmatrix}\]</p><p>Since we are planning to solve several thousands of instances of the interval problem and we are working with small arrays, we can use <a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a> to speed up the computations.</p><pre><code class="language-julia hljs">using IntervalLinearAlgebra, StaticArrays

A = @SMatrix [2..4 -2..1; -1..2 2..4]
b = @SVector [-2..2, -2..2]</code></pre><p>To perform Montecarlo, we need to sample from the intervals. This can be achieved using the <code>rand</code> function, for example </p><pre><code class="language-julia hljs">rand(1..2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.3811117895729945</code></pre><p>we are now ready for our montecarlo simulation, let us solve <span>$100000$</span> random instances</p><pre><code class="language-julia hljs">N = 100000

xs = [rand.(A)\rand.(b) for _ in 1:N]</code></pre><p>now we plot a 2D-histogram to inspect the distribution of the solutions.</p><pre><code class="language-julia hljs">using Plots

x = [xs[i][1] for i in 1:N]
y = [xs[i][2] for i in 1:N]

histogram2d(x, y, ratio=1)
xlabel!(&quot;x&quot;)
ylabel!(&quot;y&quot;)</code></pre><p><img src="../histogram-2d.png" alt/></p><p>As we can see, most of the solutions seem to be condensed close to the origin, but repeating the experiments enough times we also got some solutions farther away, obtaining a star looking area. Now the question is, <strong>have we captured the whole solution set?</strong></p><h2 id="Oettli-Präger-theorem"><a class="docs-heading-anchor" href="#Oettli-Präger-theorem">Oettli-Präger theorem</a><a id="Oettli-Präger-theorem-1"></a><a class="docs-heading-anchor-permalink" href="#Oettli-Präger-theorem" title="Permalink"></a></h2><p>The solution set <span>$\mathbf{x}$</span> is exactly characterized by the <strong>Oettli-Präger</strong> theorem <a href="../../references/#[OET64]">[OET64]</a>, which says that an interval linear system <span>$\mathbf{A}\mathbf{x}=\mathbf{b}$</span> is equivalent to the set of real inequalities</p><p class="math-container">\[|A_cx-b_c| \le A_\Delta|x| + b_\Delta,\]</p><p>where <span>$A_c$</span> and <code>A_\Delta</code> are the midpoint and radius matrix of \mathbf{A}, <span>$b_c$</span> and <span>$b_\Delta$</span> are defined similarly. The absolute values are taken elementwise.</p><p>We have now transformed the set of interval equalities into a set of real inequalities. We can easily get rid of the absolute value on the left obtaining the system</p><p class="math-container">\[\begin{cases}
A_cx-b_c \le A_\Delta|x| + b_\Delta\\
-(A_cx-b_c) \le A_\Delta|x| + b_\Delta
\end{cases}\]</p><p>We can remove the absolute value on the right by considering each orthant separately, obtaining <span>$2^n$</span> linear inequalities, where <span>$n$</span> is the dimension of the problem.</p><p>Practically this means rewriting <span>$|x|=D_ex$</span>, where <span>$e\in\{\pm 1\}^n$</span> and <span>$D_e$</span> is the diagonal matrix with e on the main diagonal. As there are <span>$2^n$</span> possible instances of <span>$e$</span>, we will go through <span>$2^n$</span> linear inequalities in the form</p><p class="math-container">\[\begin{bmatrix}
A_c-A_\Delta D_e\\
-A_c-A_\Delta D_e
\end{bmatrix}x\le \begin{bmatrix}b_\Delta+b_c\\b_\Delta-b_c\end{bmatrix}\]</p><p>as this inequality is in the form <span>$\tilde{A}x\le \tilde{b}$</span> its solution set will be a convex polytope. This has also an important theoretical consequence: the solution set of any interval linear system is composed by the union of <span>$2^n$</span> convex polytopes (some possibly empty), each lying entirely in one orthant.</p><p>In <code>IntervalLinearAlgebra.jl</code> the polytopes composing the solution set can be found using the <code>LinearOettliPrager()</code> solver. Note that to use it you need to import <code>LazySets.jl</code> first.</p><pre><code class="language-julia hljs">using LazySets

polytopes = solve(A, b, LinearOettliPrager())

plot(polytopes, ratio=1, legend=:none)
histogram2d!(x, y)
xlabel!(&quot;x&quot;)
ylabel!(&quot;y&quot;)</code></pre><p><img src="../oettli.png" alt/></p><p>As we can see, the original montecarlo approximation, despite the high number of iterations, could not cover the whole solution set.</p><p>Note also that the solution set is non-convex but is composed by <span>$4$</span> convex polygons, one in each orthant. This is a general property of interval linear systems. For example, let us consider the interval linear system</p><p class="math-container">\[\begin{bmatrix}
[4.5, 4.5]&amp;[0, 2]&amp;[0, 2]\\
[0, 2]&amp;[4.5, 4.5]&amp;[0, 2]\\
[0, 2]&amp;[0, 2]&amp; [4.5, 4.5]
\end{bmatrix}\mathbf{x}=\begin{bmatrix}[-1, 1]\\
[-1, 1]\\
[-1, 1]\end{bmatrix}\]</p><p>its solution set is depicted in the next picture.</p><p><img src="../../assets/3dexample.png" alt/></p><h2 id="Disadvantages-of-Oettli-Präger"><a class="docs-heading-anchor" href="#Disadvantages-of-Oettli-Präger">Disadvantages of Oettli-Präger</a><a id="Disadvantages-of-Oettli-Präger-1"></a><a class="docs-heading-anchor-permalink" href="#Disadvantages-of-Oettli-Präger" title="Permalink"></a></h2><p>As the number of orthants grows exponential with the dimension <span>$n$</span>, applying Oettli-Präger has exponential complexity and is thus practically unfeasible in higher dimensions. Moreover, also computing the interval hull of the solution set is NP-hard <a href="../../references/#[ROH95]">[ROH95]</a>. For this reason, in practical applications polynomial time algorithms that return an interval enclosure of the solution set are used, although these may return an interval box strictly larger than the interval hull.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../wip/">« Applications</a><a class="docs-footer-nextpage" href="../preconditioning/">Preconditioning »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Wednesday 1 September 2021 18:13">Wednesday 1 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
